<html>
<head>
  <link rel="stylesheet" type="text/css" href="kwadraty2.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <meta charset="utf-8">
  <title>Trollowe kwadraty (jQuery)</title>
</head>

<body>
<p>Gdzieś pod polami ukryty jest troll-face. Znajdź go i złap,
  klikając na niego. Długo nie może uciekać</p>
<p>Kliknąłeś:</p>
<p id="kliki">0</p>
<p>
  <button id="start">START</button>
  <button id="reset">Jeszcze raz</button>
</p>
<div id='main'>
</div>

<script>
  $('#start').on("click", wystartuj);
  $('#reset').on("click", resetuj);


  var wszystkieKwadraty = [];
  var licznik = 0;

  for (var i = 0; i < 9; ++i) {
    wszystkieKwadraty[i] = document.createElement('div');
    wszystkieKwadraty[i].id = 'a' + (i);
    wszystkieKwadraty[i].className = 'kafelek';
  }

  for (var j = 1; j <= 8; ++j) {
    var trollfaceImg = document.createElement('img');
    trollfaceImg.src = "trollface.png";
    trollfaceImg.id = 't' + j;
    wszystkieKwadraty[j].appendChild(trollfaceImg);
  }

  function wystartuj() {
    $('#start').attr("disabled", true);

    // SZUFLOWANIE
    //metoda Fisher-Yates
    function shuffle(array) {
      var currentIndex = array.length, temporaryValue, randomIndex;

      // dopóki są pozostajace elementy do szuflowania
      while (0 !== currentIndex) {

        // weź pozostały element
        randomIndex = Math.floor(Math.random() * currentIndex);
        currentIndex -= 1;

        // i zamień go z obecnym elementem
        temporaryValue = array[currentIndex];
        array[currentIndex] = array[randomIndex];
        array[randomIndex] = temporaryValue;
      }
      return array;
    }

    shuffle(wszystkieKwadraty);
    (function () {
      for (var i = 0; i < wszystkieKwadraty.length; i++) {
        $('#main').append(wszystkieKwadraty[i]);
      }
    })();

    document.getElementById('a0').addEventListener("click", funkcjaBox0);
    document.getElementById('a1').addEventListener("click", funkcjaBox1);
    document.getElementById('a2').addEventListener("click", funkcjaBox2);
    document.getElementById('a3').addEventListener("click", funkcjaBox3);
    document.getElementById('a4').addEventListener("click", funkcjaBox4);
    document.getElementById('a5').addEventListener("click", funkcjaBox5);
    document.getElementById('a6').addEventListener("click", funkcjaBox6);
    document.getElementById('a7').addEventListener("click", funkcjaBox7);
    document.getElementById('a8').addEventListener("click", funkcjaBox8);


//    $('#a0').on("click", funkcjaBox0);
//    $('#a1').on("click", funkcjaBox1);
//    $('#a2').on("click", funkcjaBox2);
//    $('#a3').on("click", funkcjaBox3);
//    $('#a4').on("click", funkcjaBox4);
//    $('#a5').on("click", funkcjaBox5);
//    $('#a6').on("click", funkcjaBox6);
//    $('#a7').on("click", funkcjaBox7);
//    $('#a8').on("click", funkcjaBox8);
  }

  function zmianyLicznika () {
    licznik = $('#kliki').html();
    licznik++;
    $('#kliki').html(licznik);
  }

  function funkcjaBox0() {
    $('#t1').addClass('show-hide');
    setTimeout(function () {
      $('#t1').removeClass('show-hide')
    }, 600);
    zmianyLicznika();
  }

  function funkcjaBox1() {
    $('#t2').addClass('show-hide');
    setTimeout(function () {
      $('#t2').removeClass('show-hide')
    }, 600);
    zmianyLicznika();
  }

  function funkcjaBox2() {
    $('#t3').addClass('show-hide');
    setTimeout(function () {
      $('#t3').removeClass('show-hide')
    }, 600);
    zmianyLicznika();
  }

  function funkcjaBox3() {
    document.getElementById('t4').classList.add('show-hide');
    setTimeout(function () {
      document.getElementById('t4').classList.remove('show-hide')
    }, 600);
    zmianyLicznika();
  }

  function funkcjaBox4() {
    document.getElementById('t5').classList.add('show-hide');
    setTimeout(function () {
      document.getElementById('t5').classList.remove('show-hide')
    }, 600);
    zmianyLicznika();
  }

  function funkcjaBox5() {
    document.getElementById('t6').classList.add('show-hide');
    setTimeout(function () {
      document.getElementById('t6').classList.remove('show-hide')
    }, 600);
    zmianyLicznika();
  }

  function funkcjaBox6() {
    document.getElementById('t7').classList.add('show-hide');
    setTimeout(function () {
      document.getElementById('t7').classList.remove('show-hide')
    }, 600);
    zmianyLicznika();
  }

  function funkcjaBox7() {
    document.getElementById('t8').classList.add('show-hide');
    setTimeout(function () {
      document.getElementById('t8').classList.remove('show-hide')
    }, 600);
    zmianyLicznika();
  }

  function funkcjaBox8() {
    document.getElementById('a8').style.backgroundImage =
      'url("trollface_sad.png")';
    document.getElementById('a8').style.backgroundSize =
      '100%';
    document.getElementById('a8').style.backgroundRepeat =
      'no-repeat';
    zmianyLicznika();

//    $('#a0').off("click", funkcjaBox0);
//    $('#a1').off("click", funkcjaBox1);
//    $('#a2').off("click", funkcjaBox2);
//    $('#a3').off("click", funkcjaBox3);
//    $('#a4').off("click", funkcjaBox4);
//    $('#a5').off("click", funkcjaBox5);
//    $('#a6').off("click", funkcjaBox6);
//    $('#a7').off("click", funkcjaBox7);
//    $('#a8').off("click", funkcjaBox8);


    document.getElementById('a0').removeEventListener("click", funkcjaBox0);
    document.getElementById('a1').removeEventListener("click", funkcjaBox1);
    document.getElementById('a2').removeEventListener("click", funkcjaBox2);
    document.getElementById('a3').removeEventListener("click", funkcjaBox3);
    document.getElementById('a4').removeEventListener("click", funkcjaBox4);
    document.getElementById('a5').removeEventListener("click", funkcjaBox5);
    document.getElementById('a6').removeEventListener("click", funkcjaBox6);
    document.getElementById('a7').removeEventListener("click", funkcjaBox7);
    document.getElementById('a8').removeEventListener("click", funkcjaBox8);

  }

  function resetuj() {
    for (var i=0; i<8; i++) {
      document.querySelectorAll('.kafelek img')[i].classList.remove('show-hide')
    }
    $('#a8').css('backgroundImage','url("")');
    $('#kliki').html(0);
    wystartuj();
  }

</script>
</body>
</html>